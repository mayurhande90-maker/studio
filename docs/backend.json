{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the MagicPixa application.",
      "properties": {
        "name": {
          "type": "string",
          "description": "User's display name."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "profilePhoto": {
          "type": "string",
          "description": "URL of the user's profile photo."
        },
        "subscriptionPlan": {
          "type": "string",
          "description": "The user's current subscription plan (e.g., 'free', 'basic', 'pro', 'premium').",
          "default": "free"
        },
        "credits": {
          "type": "number",
          "description": "Number of credits available to the user for image generation.",
          "default": 5
        },
        "creationHistory": {
          "type": "array",
          "description": "A history of images generated by the user.",
          "items": {
            "type": "object",
            "properties": {
              "imageUrl": {
                "type": "string",
                "format": "uri"
              },
              "timestamp": {
                "type": "string",
                "format": "date-time"
              }
            },
            "required": ["imageUrl", "timestamp"]
          }
        }
      },
      "required": [
        "name",
        "email",
        "profilePhoto",
        "subscriptionPlan",
        "credits",
        "creationHistory"
      ]
    },
    "ImageGeneration": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ImageGeneration",
      "type": "object",
      "description": "Represents a single image generation request and its outcome.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the image generation record."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N ImageGeneration)"
        },
        "inputPrompt": {
          "type": "string",
          "description": "The prompt used for image generation."
        },
        "processedImageUrl": {
          "type": "string",
          "description": "URL of the processed (generated) image."
        },
        "timestamp": {
          "type": "string",
          "description": "Timestamp of when the image generation was requested.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "inputPrompt",
        "processedImageUrl",
        "timestamp"
      ]
    },
    "Job": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Job",
      "type": "object",
      "description": "Represents an image processing job in the queue.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the job."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Job)"
        },
        "inputPrompt": {
          "type": "string",
          "description": "The prompt used for image generation."
        },
        "inputImage": {
          "type": "string",
          "description": "URL or reference to the input image (optional)."
        },
        "status": {
          "type": "string",
          "description": "The status of the job (e.g., 'pending', 'processing', 'completed', 'failed')."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp of when the job was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "inputPrompt",
        "status",
        "createdAt"
      ]
    },
    "Subscription": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Subscription",
      "type": "object",
      "description": "Represents a user's subscription plan and related payment information.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the subscription."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:1 Subscription)"
        },
        "planName": {
          "type": "string",
          "description": "The name of the subscription plan (e.g., 'basic', 'pro', 'premium')."
        },
        "startDate": {
          "type": "string",
          "description": "The date the subscription started.",
          "format": "date-time"
        },
        "endDate": {
          "type": "string",
          "description": "The date the subscription ends.",
          "format": "date-time"
        },
        "paymentId": {
          "type": "string",
          "description": "Identifier for the payment in the payment gateway (e.g., Razorpay)."
        },
        "active": {
          "type": "boolean",
          "description": "Indicates whether the subscription is currently active."
        }
      },
      "required": [
        "id",
        "userId",
        "planName",
        "startDate",
        "endDate",
        "paymentId",
        "active"
      ]
    },
    "Log": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Log",
      "type": "object",
      "description": "Represents a log entry for an image generation attempt.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the log entry."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Log)"
        },
        "apiProviderUsed": {
          "type": "string",
          "description": "The API provider used for image generation (e.g., 'Gemini', 'ChatGPT', 'Perplexity')."
        },
        "success": {
          "type": "boolean",
          "description": "Indicates whether the image generation was successful."
        },
        "generationDuration": {
          "type": "number",
          "description": "The duration of the image generation process in milliseconds."
        },
        "timestamp": {
          "type": "string",
          "description": "Timestamp of when the image generation attempt occurred.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "apiProviderUsed",
        "success",
        "generationDuration",
        "timestamp"
      ]
    }
  },
  "auth": {
    "providers": [
      "password"
    ]
  },
  "firestore": {
    "/users/{userId}": {
      "schema": {
        "$ref": "#/entities/User"
      },
      "description": "Stores user profile information. User data is private and accessible only to the user with matching userId. Includes standard profile information (name, email, profilePhoto, subscriptionPlan, credits)."
    },
    "/jobs/{jobId}": {
      "schema": {
        "$ref": "#/entities/Job"
      },
      "description": "Stores image processing jobs. The Firebase Function `processImageJob` processes the documents in this collection. The userId field allows for tracing the job back to the user who requested it."
    },
    "/aiGenerationLogs/{logId}": {
      "schema": {
        "$ref": "#/entities/Log"
      },
      "description": "Stores logs for each image generation attempt. Contains information about the API provider used, success/failure status, and generation duration. Accessible to admins only."
    }
  }
}
